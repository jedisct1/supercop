#include <stdint.h>
#include "params.h"

const int16_t zetas[812] __attribute__((aligned(32))) = {13688, 13688, 2424, 2424, 28816, 28816, 2192, 2192, -21308, -21308, 708, 708, -16436, -16436, 460, 460, -28815, -28815, 1265, 1265, 28626, 28626, 722, 722, -23981, -23981, 723, 723, 12929, 12929, 1, 1, -2786, -2786, 2590, 2590, -19583, -19583, 257, 257, -16796, -16796, 1124, 1124, -21194, -21194, -21194, -21194, -21194, -21194, -21194, -21194, -2066, -2066, -2066, -2066, -2066, -2066, -2066, -2066, 1590, 1590, 1590, 1590, 1590, 1590, 1590, 1590, 1262, 1262, 1262, 1262, 1262, 1262, 1262, 1262, 13347, 13347, 13347, 13347, 13347, 13347, 13347, 13347, -11829, -11829, -11829, -11829, -11829, -11829, -11829, -11829, 3235, 3235, 3235, 3235, 3235, 3235, 3235, 3235, 1611, 1611, 1611, 1611, 1611, 1611, 1611, 1611, 32513, 32513, 32513, 32513, 32513, 32513, 32513, 32513, -15412, -15412, -15412, -15412, -15412, -15412, -15412, -15412, 3201, 3201, 3201, 3201, 3201, 3201, 3201, 3201, 1484, 1484, 1484, 1484, 1484, 1484, 1484, 1484, -28132, -28132, -28132, -28132, -28132, -28132, -28132, -28132, -4853, -4853, -4853, -4853, -4853, -4853, -4853, -4853, 3100, 3100, 3100, 3100, 3100, 3100, 3100, 3100, 395, 395, 395, 395, 395, 395, 395, 395, 30143, 30143, 30143, 30143, 30143, 30143, 30143, 30143, 23925, 23925, 23925, 23925, 23925, 23925, 23925, 23925, 2111, 2111, 2111, 2111, 2111, 2111, 2111, 2111, 2293, 2293, 2293, 2293, 2293, 2293, 2293, 2293, -4208, -4208, -4208, -4208, -4208, -4208, -4208, -4208, 30541, 30541, 30541, 30541, 30541, 30541, 30541, 30541, 1936, 1936, 1936, 1936, 1936, 1936, 1936, 1936, 1741, 1741, 1741, 1741, 1741, 1741, 1741, 1741, 7337, 7337, 7337, 7337, -16929, -16929, -16929, -16929, -6597, -6597, -6597, -6597, 17764, 17764, 17764, 17764, 1577, 1577, 1577, 1577, 95, 95, 95, 95, 699, 699, 699, 699, 2916, 2916, 2916, 2916, -20057, -20057, -20057, -20057, -20948, -20948, -20948, -20948, 11432, 11432, 11432, 11432, -32474, -32474, -32474, -32474, 39, 39, 39, 39, 44, 44, 44, 44, 2216, 2216, 2216, 2216, 550, 550, 550, 550, 15546, 15546, 15546, 15546, 4095, 4095, 4095, 4095, -2293, -2293, -2293, -2293, -14350, -14350, -14350, -14350, 3002, 3002, 3002, 3002, 639, 639, 639, 639, 2955, 2955, 2955, 2955, 2802, 2802, 2802, 2802, -2597, -2597, -2597, -2597, 3792, 3792, 3792, 3792, 304, 304, 304, 304, -18142, -18142, -18142, -18142, 603, 603, 603, 603, 1744, 1744, 1744, 1744, 2352, 2352, 2352, 2352, 1058, 1058, 1058, 1058, 8456, 8456, 8456, 8456, -22388, -22388, -22388, -22388, -25384, -25384, -25384, -25384, 15053, 15053, 15053, 15053, 3336, 3336, 3336, 3336, 2700, 2700, 2700, 2700, 216, 216, 216, 216, 2637, 2637, 2637, 2637, -11260, -11260, -11260, -11260, -22786, -22786, -22786, -22786, -9687, -9687, -9687, -9687, -22692, -22692, -22692, -22692, 2564, 2564, 2564, 2564, 3070, 3070, 3070, 3070, 937, 937, 937, 937, 348, 348, 348, 348, 19811, 19811, -1175, -1175, 18257, 18257, -14692, -14692, 16835, 16835, 8911, 8911, 13821, 13821, -19696, -19696, 1507, 1507, 1257, 1257, 3281, 3281, 156, 156, 2627, 2627, 3407, 3407, 3453, 3453, 2832, 2832, 30389, 30389, -19488, -19488, 19413, 19413, 18541, 18541, 2181, 2181, 29347, 29347, -5516, -5516, -26388, -26388, 565, 565, 992, 992, 1877, 1877, 2029, 2029, 3077, 3077, 2851, 2851, 2164, 2164, 2796, 2796, 9176, 9176, -8132, -8132, -16379, -16379, -3355, -3355, 209, 209, -16568, -16568, -30161, -30161, -10502, -10502, 2008, 2008, 2620, 2620, 901, 901, 1637, 1637, 1617, 1617, 2888, 2888, 1199, 1199, 1530, 1530, -2957, -2957, -3336, -3336, 28569, 28569, 23830, 23830, 11849, 11849, -75, -75, -15734, -15734, -947, -947, 1267, 1267, 1784, 1784, 281, 281, 1558, 1558, 1993, 1993, 2869, 2869, 2442, 2442, 3021, 3021, 27072, 27072, -29952, -29952, 10711, 10711, 18806, 18806, 12531, 12531, -24512, -24512, -7203, -7203, -11488, -11488, 2496, 2496, 2816, 2816, 87, 87, 630, 630, 371, 371, 64, 64, 2909, 2909, 800, 800, -31033, -31033, 17081, 17081, -27469, -27469, -15867, -15867, -29004, -29004, 22731, 22731, 30655, 30655, -10786, -10786, 1351, 1351, 1081, 1081, 1331, 1331, 1413, 1413, 3252, 3252, 3403, 3403, 2623, 2623, 2782, 2782, -6843, -4360, 12759, 11034, -28455, 26712, 4759, -26559, 19963, 22522, 20152, 19375, -30824, 512, 7906, -26369, 2245, 760, 2135, 2586, 601, 3160, 2327, 1473, 2683, 1786, 696, 1583, 2968, 512, 2530, 2943, -23658, -26692, 31944, -5971, 29252, -606, 5195, -7582, -29384, 29024, 25915, 2351, 26143, -27640, 31868, -17820, 3222, 444, 2248, 2093, 2116, 2210, 2251, 3426, 312, 352, 443, 943, 2207, 8, 1660, 100, 32399, -417, -21004, -5213, -6710, 32759, -18350, 16266, 13877, 5574, -23147, 4133, 30105, -14767, -16910, -20758, 2319, 223, 3060, 1059, 3274, 1655, 2898, 1674, 437, 1734, 277, 933, 1817, 3025, 242, 1514, 27053, -16530, -22293, -10028, 2105, 17498, -6464, -10654, 7868, 474, 38, -26843, 1669, -1478, 20854, -18483, 2349, 3182, 3435, 1748, 2489, 858, 1728, 354, 2236, 218, 294, 2725, 2565, 2362, 2678, 1869, -19033, -24834, 24228, 17252, 17441, -27374, 21403, -14502, -31621, -25592, -2047, 7773, -24549, 14313, -11962, 15072, 1063, 1022, 1188, 2404, 417, 2066, 27, 1626, 251, 2056, 1409, 1501, 3227, 361, 582, 2784, -20777, 30332, 2427, -14066, -24303, -29099, 23887, -3298, 3602, 5745, -20511, -26502, 14977, 13536, -9402, -27412, 1367, 124, 1531, 1550, 1681, 2517, 1999, 2078, 274, 3057, 3425, 1914, 2049, 1248, 3142, 1772};
const int16_t zetas_inv[816] __attribute__((aligned(32))) = {27413, 9403, -13535, -14976, 26503, 20512, -5744, -3601, 3299, -23886, 29100, 24304, 14067, -2426, -30331, 20778, 1685, 315, 2209, 1408, 1543, 32, 400, 3183, 1379, 1458, 940, 1776, 1907, 1926, 3333, 2090, -15071, 11963, -14312, 24550, -7772, 2048, 25593, 31622, 14503, -21402, 27375, -17440, -17251, -24227, 24835, 19034, 673, 2875, 3096, 230, 1956, 2048, 1401, 3206, 1831, 3430, 1391, 3040, 1053, 2269, 2435, 2394, 18484, -20853, 1479, -1668, 26844, -37, -473, -7867, 10655, 6465, -17497, -2104, 10029, 22294, 16531, -27052, 1588, 779, 1095, 892, 732, 3163, 3239, 1221, 3103, 1729, 2599, 968, 1709, 22, 275, 1108, 20759, 16911, 14768, -30104, -4132, 23148, -5573, -13876, -16265, 18351, -32758, 6711, 5214, 21005, 418, -32398, 1943, 3215, 432, 1640, 2524, 3180, 1723, 3020, 1783, 559, 1802, 183, 2398, 397, 3234, 1138, 17821, -31867, 27641, -26142, -2350, -25914, -29023, 29385, 7583, -5194, 607, -29251, 5972, -31943, 26693, 23659, 3357, 1797, 3449, 1250, 2514, 3014, 3105, 3145, 31, 1206, 1247, 1341, 1364, 1209, 3013, 235, 26370, -7905, -511, 30825, -19374, -20151, -22521, -19962, 26560, -4758, -26711, 28456, -11033, -12758, 4361, 6844, 514, 927, 2945, 489, 1874, 2761, 1671, 774, 1984, 1130, 297, 2856, 871, 1322, 2697, 1212, 10787, 10787, -30654, -30654, -22730, -22730, 29005, 29005, 15868, 15868, 27470, 27470, -17080, -17080, 31034, 31034, 675, 675, 834, 834, 54, 54, 205, 205, 2044, 2044, 2126, 2126, 2376, 2376, 2106, 2106, 11489, 11489, 7204, 7204, 24513, 24513, -12530, -12530, -18805, -18805, -10710, -10710, 29953, 29953, -27071, -27071, 2657, 2657, 548, 548, 3393, 3393, 3086, 3086, 2827, 2827, 3370, 3370, 641, 641, 961, 961, 948, 948, 15735, 15735, 76, 76, -11848, -11848, -23829, -23829, -28568, -28568, 3337, 3337, 2958, 2958, 436, 436, 1015, 1015, 588, 588, 1464, 1464, 1899, 1899, 3176, 3176, 1673, 1673, 2190, 2190, 10503, 10503, 30162, 30162, 16569, 16569, -208, -208, 3356, 3356, 16380, 16380, 8133, 8133, -9175, -9175, 1927, 1927, 2258, 2258, 569, 569, 1840, 1840, 1820, 1820, 2556, 2556, 837, 837, 1449, 1449, 26389, 26389, 5517, 5517, -29346, -29346, -2180, -2180, -18540, -18540, -19412, -19412, 19489, 19489, -30388, -30388, 661, 661, 1293, 1293, 606, 606, 380, 380, 1428, 1428, 1580, 1580, 2465, 2465, 2892, 2892, 19697, 19697, -13820, -13820, -8910, -8910, -16834, -16834, 14693, 14693, -18256, -18256, 1176, 1176, -19810, -19810, 625, 625, 4, 4, 50, 50, 830, 830, 3301, 3301, 176, 176, 2200, 2200, 1950, 1950, 22693, 22693, 22693, 22693, 9688, 9688, 9688, 9688, 22787, 22787, 22787, 22787, 11261, 11261, 11261, 11261, 3109, 3109, 3109, 3109, 2520, 2520, 2520, 2520, 387, 387, 387, 387, 893, 893, 893, 893, -15052, -15052, -15052, -15052, 25385, 25385, 25385, 25385, 22389, 22389, 22389, 22389, -8455, -8455, -8455, -8455, 820, 820, 820, 820, 3241, 3241, 3241, 3241, 757, 757, 757, 757, 121, 121, 121, 121, 18143, 18143, 18143, 18143, -303, -303, -303, -303, -3791, -3791, -3791, -3791, 2598, 2598, 2598, 2598, 2399, 2399, 2399, 2399, 1105, 1105, 1105, 1105, 1713, 1713, 1713, 1713, 2854, 2854, 2854, 2854, 14351, 14351, 14351, 14351, 2294, 2294, 2294, 2294, -4094, -4094, -4094, -4094, -15545, -15545, -15545, -15545, 655, 655, 655, 655, 502, 502, 502, 502, 2818, 2818, 2818, 2818, 455, 455, 455, 455, 32475, 32475, 32475, 32475, -11431, -11431, -11431, -11431, 20949, 20949, 20949, 20949, 20058, 20058, 20058, 20058, 2907, 2907, 2907, 2907, 1241, 1241, 1241, 1241, 3413, 3413, 3413, 3413, 3418, 3418, 3418, 3418, -17763, -17763, -17763, -17763, 6598, 6598, 6598, 6598, 16930, 16930, 16930, 16930, -7336, -7336, -7336, -7336, 541, 541, 541, 541, 2758, 2758, 2758, 2758, 3362, 3362, 3362, 3362, 1880, 1880, 1880, 1880, -30540, -30540, -30540, -30540, -30540, -30540, -30540, -30540, 4209, 4209, 4209, 4209, 4209, 4209, 4209, 4209, 1716, 1716, 1716, 1716, 1716, 1716, 1716, 1716, 1521, 1521, 1521, 1521, 1521, 1521, 1521, 1521, -23924, -23924, -23924, -23924, -23924, -23924, -23924, -23924, -30142, -30142, -30142, -30142, -30142, -30142, -30142, -30142, 1164, 1164, 1164, 1164, 1164, 1164, 1164, 1164, 1346, 1346, 1346, 1346, 1346, 1346, 1346, 1346, 4854, 4854, 4854, 4854, 4854, 4854, 4854, 4854, 28133, 28133, 28133, 28133, 28133, 28133, 28133, 28133, 3062, 3062, 3062, 3062, 3062, 3062, 3062, 3062, 357, 357, 357, 357, 357, 357, 357, 357, 15413, 15413, 15413, 15413, 15413, 15413, 15413, 15413, -32512, -32512, -32512, -32512, -32512, -32512, -32512, -32512, 1973, 1973, 1973, 1973, 1973, 1973, 1973, 1973, 256, 256, 256, 256, 256, 256, 256, 256, 11830, 11830, 11830, 11830, 11830, 11830, 11830, 11830, -13346, -13346, -13346, -13346, -13346, -13346, -13346, -13346, 1846, 1846, 1846, 1846, 1846, 1846, 1846, 1846, 222, 222, 222, 222, 222, 222, 222, 222, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 2067, 21195, 21195, 21195, 21195, 21195, 21195, 21195, 21195, 2195, 2195, 2195, 2195, 2195, 2195, 2195, 2195, 1867, 1867, 1867, 1867, 1867, 1867, 1867, 1867, 16797, 16797, 2333, 2333, 19584, 19584, 3200, 3200, 2787, 2787, 867, 867, -12928, -12928, 3456, 3456, 23982, 23982, 2734, 2734, -28625, -28625, 2735, 2735, -4872, -4872, 248, 248, -6938, -6938, 1510, 1510, 29783, 29783, 2775, 2775, 4873, 4873, 3209, 3209, -30976, -30976, 1792, 1792, 15375, 15375, 1679, 1679};

#define QINV 12929
#define LOW ((1U << 12) - 1)
#define V ((1U << 26)/NTRUPLUS_Q)

#define WQINV 13707
#define W 2571

const uint16_t _low_mask[16] __attribute__((aligned(32))) = {LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW};
const uint16_t _4x1[4] __attribute__((aligned(32))) = {1, 1, 1, 1};
const uint16_t _4x01[4] __attribute__((aligned(32))) = {1, 0, 0, 0};
const uint32_t _8x1[8] __attribute__((aligned(32))) = {1, 1, 1, 1, 1, 1, 1, 1};

const uint16_t _16xv[16] __attribute__((aligned(32))) = {V, V, V, V, V, V, V, V, V, V, V, V, V, V, V, V};
const uint16_t _16x1[16] __attribute__((aligned(32))) = {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};
const uint16_t _16xq[16]  __attribute__((aligned(32))) = {NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q};
const uint16_t _16xqinv[16] __attribute__((aligned(32))) = {QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV};

const uint16_t _16xw[16] __attribute__((aligned(32))) = {W, W, W, W, W, W, W, W, W, W, W, W, W, W, W, W};
const uint16_t _16xwqinv[16] __attribute__((aligned(32))) = {WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV};

#undef QINV
#undef LOW
#undef V
#undef WQINV
#undef W