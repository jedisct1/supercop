#include <stdint.h>
#include "params.h"

const int16_t zetas[812] __attribute__((aligned(32))) = {
	 13687,  13687,  -1033,  -1033,  29782,  29782,   -682,   -682,
	  4872,   4872,   -248,   -248,  21308,  21308,   -708,   -708,
	-29782, -29782,    682,    682,  12929,  12929,      1,      1,
	-28626, -28626,   -722,   -722,  23981,  23981,   -723,   -723,
	 19583,  19583,   -257,   -257,  16796,  16796,  -1124,  -1124,
	 -2787,  -2787,   -867,   -867,  32512,  32512,  32512,  32512,
	 32512,  32512,  32512,  32512, -15412, -15412, -15412, -15412,
	-15412, -15412, -15412, -15412,   -256,   -256,   -256,   -256,
	  -256,   -256,   -256,   -256,   1484,   1484,   1484,   1484,
	  1484,   1484,   1484,   1484,  -2066,  -2066,  -2066,  -2066,
	 -2066,  -2066,  -2066,  -2066,  21194,  21194,  21194,  21194,
	 21194,  21194,  21194,  21194,   1262,   1262,   1262,   1262,
	  1262,   1262,   1262,   1262,  -1590,  -1590,  -1590,  -1590,
	 -1590,  -1590,  -1590,  -1590, -11829, -11829, -11829, -11829,
	-11829, -11829, -11829, -11829, -13346, -13346, -13346, -13346,
	-13346, -13346, -13346, -13346,   1611,   1611,   1611,   1611,
	  1611,   1611,   1611,   1611,    222,    222,    222,    222,
	   222,    222,    222,    222, -23924, -23924, -23924, -23924,
	-23924, -23924, -23924, -23924,  30142,  30142,  30142,  30142,
	 30142,  30142,  30142,  30142,   1164,   1164,   1164,   1164,
	  1164,   1164,   1164,   1164,  -1346,  -1346,  -1346,  -1346,
	 -1346,  -1346,  -1346,  -1346, -30540, -30540, -30540, -30540,
	-30540, -30540, -30540, -30540,  -4209,  -4209,  -4209,  -4209,
	 -4209,  -4209,  -4209,  -4209,   1716,   1716,   1716,   1716,
	  1716,   1716,   1716,   1716,  -1521,  -1521,  -1521,  -1521,
	 -1521,  -1521,  -1521,  -1521, -28133, -28133, -28133, -28133,
	-28133, -28133, -28133, -28133,  -4853,  -4853,  -4853,  -4853,
	 -4853,  -4853,  -4853,  -4853,   -357,   -357,   -357,   -357,
	  -357,   -357,   -357,   -357,    395,    395,    395,    395,
	   395,    395,    395,    395,  15545,  15545,  15545,  15545,
	  4095,   4095,   4095,   4095,   2294,   2294,   2294,   2294,
	 14351,  14351,  14351,  14351,   -455,   -455,   -455,   -455,
	   639,    639,    639,    639,    502,    502,    502,    502,
	   655,    655,    655,    655,   6597,   6597,   6597,   6597,
	-17763, -17763, -17763, -17763, -16929, -16929, -16929, -16929,
	 -7337,  -7337,  -7337,  -7337,   -699,   -699,   -699,   -699,
	   541,    541,    541,    541,     95,     95,     95,     95,
	 -1577,  -1577,  -1577,  -1577,  11431,  11431,  11431,  11431,
	-32474, -32474, -32474, -32474,  20948,  20948,  20948,  20948,
	-20057, -20057, -20057, -20057,  -1241,  -1241,  -1241,  -1241,
	   550,    550,    550,    550,    -44,    -44,    -44,    -44,
	    39,     39,     39,     39,  15052,  15052,  15052,  15052,
	 25384,  25384,  25384,  25384,   8455,   8455,   8455,   8455,
	-22389, -22389, -22389, -22389,   -820,   -820,   -820,   -820,
	  -216,   -216,   -216,   -216,   -121,   -121,   -121,   -121,
	  -757,   -757,   -757,   -757,  22692,  22692,  22692,  22692,
	 -9687,  -9687,  -9687,  -9687,  11261,  11261,  11261,  11261,
	 22787,  22787,  22787,  22787,   -348,   -348,   -348,   -348,
	   937,    937,    937,    937,    893,    893,    893,    893,
	   387,    387,    387,    387,   2597,   2597,   2597,   2597,
	 -3791,  -3791,  -3791,  -3791,    303,    303,    303,    303,
	-18142, -18142, -18142, -18142,   -603,   -603,   -603,   -603,
	  1713,   1713,   1713,   1713,  -1105,  -1105,  -1105,  -1105,
	  1058,   1058,   1058,   1058,  -9175,  -9175,   8133,   8133,
	-16379, -16379,  -3355,  -3355, -16569, -16569,   -209,   -209,
	 10502,  10502, -30161, -30161,   1449,   1449,    837,    837,
	   901,    901,   1637,   1637,   -569,   -569,  -1617,  -1617,
	 -1530,  -1530,   1199,   1199,  -8910,  -8910,  16834,  16834,
	-19697, -19697, -13820, -13820, -18256, -18256,  14692,  14692,
	 -1175,  -1175, -19811, -19811,     50,     50,   -830,   -830,
	  -625,   -625,      4,      4,    176,    176,   -156,   -156,
	  1257,   1257,  -1507,  -1507,   2180,   2180,  29346,  29346,
	  5517,   5517,  26389,  26389, -18540, -18540,  19412,  19412,
	-30389, -30389,  19488,  19488,   -380,   -380,   -606,   -606,
	  1293,   1293,    661,    661,   1428,   1428,  -1580,  -1580,
	  -565,   -565,   -992,   -992,   7204,   7204,  11488,  11488,
	-24512, -24512, -12531, -12531, -27071, -27071,  29953,  29953,
	 10711,  10711,  18806,  18806,    548,    548,   -800,   -800,
	    64,     64,   -371,   -371,    961,    961,    641,    641,
	    87,     87,    630,    630,  10787,  10787,  30654,  30654,
	 29005,  29005, -22730, -22730, -17081, -17081, -31033, -31033,
	-15867, -15867,  27469,  27469,    675,    675,   -834,   -834,
	   205,    205,     54,     54,  -1081,  -1081,   1351,   1351,
	  1413,   1413,  -1331,  -1331,  -3337,  -3337,   2957,   2957,
	-23830, -23830,  28569,  28569,  11848,  11848,    -76,    -76,
	 15735,  15735,    948,    948,  -1673,  -1673,  -1267,  -1267,
	 -1558,  -1558,    281,    281,  -1464,  -1464,   -588,   -588,
	  1015,   1015,    436,    436,   -417, -32398,   5213, -21005,
	 -6711,  32759,  18351, -16266, -23147,   4133,  -5573,  13877,
	 20758, -16910, -30104,  14768,    223,   1138,  -1059,   -397,
	  -183,   1655,    559,  -1674,    277,    933,   1723,    437,
	 -1514,    242,   1640,    432, -19375,  20152, -19962, -22521,
	 -7905,  26370,    512,  30825, -26711, -28455, -26559,  -4758,
	-12758, -11033,  -4360,   6844,  -1583,    696,    774,   1671,
	   927,    514,    512,    489,    297,    601,   1473,   1130,
	  1322,    871,    760,   1212,  29384, -29024,  25915,   2351,
	-27640, -26142,  17820,  31868,  -7583,  -5194,  29251,   -607,
	-26692,  23659,   5972,  31943,   -312,   -352,    443,    943,
	     8,   1250,   -100,   1660,    -31,   1206,  -1341,  -1247,
	   444,    235,   1364,  -1209,  14313,  24550, -15071, -11962,
	 -2047,   7773,  25593, -31621, -24834,  19033, -17251,  24228,
	 17441, -27375, -21403,  14502,    361,    230,    673,    582,
	  1409,   1501,   1401,    251,   1022,  -1063,   1053,   1188,
	   417,  -1391,    -27,  -1626,  27413,  -9403, -14976, -13536,
	 -5744,   3602, -26503,  20512,  14066,   2427,  20777, -30332,
	-23886,   3299, -29100,  24303,   1685,   -315,   1408,  -1248,
	   400,    274,  -1543,     32,  -1550,   1531,  -1367,   -124,
	  1458,   1379,   -940,  -1681,  22294,  10029, -16531, -27052,
	-10654,   6464,   2104,  17498,  -7867,   -474,     38, -26844,
	 -1479,  -1668,  18484,  20853,     22,   1709,   -275,   1108,
	   354,  -1728,   -968,    858,   1221,   -218,    294,   -732,
	 -1095,    892,   1588,   -779
};

const int16_t zetas_inv[1632] __attribute__((aligned(32))) = {
	-20853, -18484,   1668,   1479,  26844,    -38,    474,   7867,
	-17498,  -2104,  -6464,  10654,  27052,  16531, -10029, -22294,
	   779,  -1588,   -892,   1095,    732,   -294,    218,  -1221,
	  -858,    968,   1728,   -354,  -1108,    275,  -1709,    -22,
	-24303,  29100,  -3299,  23886,  30332, -20777,  -2427, -14066,
	-20512,  26503,  -3602,   5744,  13536,  14976,   9403, -27413,
	  1681,    940,  -1379,  -1458,    124,   1367,  -1531,   1550,
	   -32,   1543,   -274,   -400,   1248,  -1408,    315,  -1685,
	-14502,  21403,  27375, -17441, -24228,  17251, -19033,  24834,
	 31621, -25593,  -7773,   2047,  11962,  15071, -24550, -14313,
	  1626,     27,   1391,   -417,  -1188,  -1053,   1063,  -1022,
	  -251,  -1401,  -1501,  -1409,   -582,   -673,   -230,   -361,
	-31943,  -5972, -23659,  26692,    607, -29251,   5194,   7583,
	-31868, -17820,  26142,  27640,  -2351, -25915,  29024, -29384,
	  1209,  -1364,   -235,   -444,   1247,   1341,  -1206,     31,
	 -1660,    100,  -1250,     -8,   -943,   -443,    352,    312,
	 -6844,   4360,  11033,  12758,   4758,  26559,  28455,  26711,
	-30825,   -512, -26370,   7905,  22521,  19962, -20152,  19375,
	 -1212,   -760,   -871,  -1322,  -1130,  -1473,   -601,   -297,
	  -489,   -512,   -514,   -927,  -1671,   -774,   -696,   1583,
	-14768,  30104,  16910, -20758, -13877,   5573,  -4133,  23147,
	 16266, -18351, -32759,   6711,  21005,  -5213,  32398,    417,
	  -432,  -1640,   -242,   1514,   -437,  -1723,   -933,   -277,
	  1674,   -559,  -1655,    183,    397,   1059,  -1138,   -223,
	  -948,   -948, -15735, -15735,     76,     76, -11848, -11848,
	-28569, -28569,  23830,  23830,  -2957,  -2957,   3337,   3337,
	  -436,   -436,  -1015,  -1015,    588,    588,   1464,   1464,
	  -281,   -281,   1558,   1558,   1267,   1267,   1673,   1673,
	-27469, -27469,  15867,  15867,  31033,  31033,  17081,  17081,
	 22730,  22730, -29005, -29005, -30654, -30654, -10787, -10787,
	  1331,   1331,  -1413,  -1413,  -1351,  -1351,   1081,   1081,
	   -54,    -54,   -205,   -205,    834,    834,   -675,   -675,
	-18806, -18806, -10711, -10711, -29953, -29953,  27071,  27071,
	 12531,  12531,  24512,  24512, -11488, -11488,  -7204,  -7204,
	  -630,   -630,    -87,    -87,   -641,   -641,   -961,   -961,
	   371,    371,    -64,    -64,    800,    800,   -548,   -548,
	-19488, -19488,  30389,  30389, -19412, -19412,  18540,  18540,
	-26389, -26389,  -5517,  -5517, -29346, -29346,  -2180,  -2180,
	   992,    992,    565,    565,   1580,   1580,  -1428,  -1428,
	  -661,   -661,  -1293,  -1293,    606,    606,    380,    380,
	 19811,  19811,   1175,   1175, -14692, -14692,  18256,  18256,
	 13820,  13820,  19697,  19697, -16834, -16834,   8910,   8910,
	  1507,   1507,  -1257,  -1257,    156,    156,   -176,   -176,
	    -4,     -4,    625,    625,    830,    830,    -50,    -50,
	 30161,  30161, -10502, -10502,    209,    209,  16569,  16569,
	  3355,   3355,  16379,  16379,  -8133,  -8133,   9175,   9175,
	 -1199,  -1199,   1530,   1530,   1617,   1617,    569,    569,
	 -1637,  -1637,   -901,   -901,   -837,   -837,  -1449,  -1449,
	 18142,  18142,  18142,  18142,   -303,   -303,   -303,   -303,
	  3791,   3791,   3791,   3791,  -2597,  -2597,  -2597,  -2597,
	 -1058,  -1058,  -1058,  -1058,   1105,   1105,   1105,   1105,
	 -1713,  -1713,  -1713,  -1713,    603,    603,    603,    603,
	-22787, -22787, -22787, -22787, -11261, -11261, -11261, -11261,
	  9687,   9687,   9687,   9687, -22692, -22692, -22692, -22692,
	  -387,   -387,   -387,   -387,   -893,   -893,   -893,   -893,
	  -937,   -937,   -937,   -937,    348,    348,    348,    348,
	 22389,  22389,  22389,  22389,  -8455,  -8455,  -8455,  -8455,
	-25384, -25384, -25384, -25384, -15052, -15052, -15052, -15052,
	   757,    757,    757,    757,    121,    121,    121,    121,
	   216,    216,    216,    216,    820,    820,    820,    820,
	 20057,  20057,  20057,  20057, -20948, -20948, -20948, -20948,
	 32474,  32474,  32474,  32474, -11431, -11431, -11431, -11431,
	   -39,    -39,    -39,    -39,     44,     44,     44,     44,
	  -550,   -550,   -550,   -550,   1241,   1241,   1241,   1241,
	  7337,   7337,   7337,   7337,  16929,  16929,  16929,  16929,
	 17763,  17763,  17763,  17763,  -6597,  -6597,  -6597,  -6597,
	  1577,   1577,   1577,   1577,    -95,    -95,    -95,    -95,
	  -541,   -541,   -541,   -541,    699,    699,    699,    699,
	-14351, -14351, -14351, -14351,  -2294,  -2294,  -2294,  -2294,
	 -4095,  -4095,  -4095,  -4095, -15545, -15545, -15545, -15545,
	  -655,   -655,   -655,   -655,   -502,   -502,   -502,   -502,
	  -639,   -639,   -639,   -639,    455,    455,    455,    455,
	  4853,   4853,   4853,   4853,   4853,   4853,   4853,   4853,
	 28133,  28133,  28133,  28133,  28133,  28133,  28133,  28133,
	  -395,   -395,   -395,   -395,   -395,   -395,   -395,   -395,
	   357,    357,    357,    357,    357,    357,    357,    357,
	  4209,   4209,   4209,   4209,   4209,   4209,   4209,   4209,
	 30540,  30540,  30540,  30540,  30540,  30540,  30540,  30540,
	  1521,   1521,   1521,   1521,   1521,   1521,   1521,   1521,
	 -1716,  -1716,  -1716,  -1716,  -1716,  -1716,  -1716,  -1716,
	-30142, -30142, -30142, -30142, -30142, -30142, -30142, -30142,
	 23924,  23924,  23924,  23924,  23924,  23924,  23924,  23924,
	  1346,   1346,   1346,   1346,   1346,   1346,   1346,   1346,
	 -1164,  -1164,  -1164,  -1164,  -1164,  -1164,  -1164,  -1164,
	 13346,  13346,  13346,  13346,  13346,  13346,  13346,  13346,
	 11829,  11829,  11829,  11829,  11829,  11829,  11829,  11829,
	  -222,   -222,   -222,   -222,   -222,   -222,   -222,   -222,
	 -1611,  -1611,  -1611,  -1611,  -1611,  -1611,  -1611,  -1611,
	-21194, -21194, -21194, -21194, -21194, -21194, -21194, -21194,
	  2066,   2066,   2066,   2066,   2066,   2066,   2066,   2066,
	  1590,   1590,   1590,   1590,   1590,   1590,   1590,   1590,
	 -1262,  -1262,  -1262,  -1262,  -1262,  -1262,  -1262,  -1262,
	 15412,  15412,  15412,  15412,  15412,  15412,  15412,  15412,
	-32512, -32512, -32512, -32512, -32512, -32512, -32512, -32512,
	 -1484,  -1484,  -1484,  -1484,  -1484,  -1484,  -1484,  -1484,
	   256,    256,    256,    256,    256,    256,    256,    256,
	  2787,   2787,    867,    867, -16796, -16796,   1124,   1124,
	-19583, -19583,    257,    257, -23981, -23981,    723,    723,
	 28626,  28626,    722,    722, -12929, -12929,     -1,     -1,
	-16436, -16436,    460,    460, -28815, -28815,   1265,   1265,
	  6938,   6938,  -1510,  -1510,  16436,  16436,   -460,   -460,
	-30977, -30977,  -1665,  -1665,  15375,  15375,   1679,   1679
};

#define QINV 12929
#define LOW ((1U << 12) - 1)
#define V ((1U << 26)/NTRUPLUS_Q)

#define WQINV 13706
#define W -886

const uint16_t _low_mask[16] __attribute__((aligned(32))) = {LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW, LOW};
const uint16_t _4x1[4] __attribute__((aligned(32))) = {1, 1, 1, 1};
const uint16_t _4x01[4] __attribute__((aligned(32))) = {1, 0, 0, 0};
const uint32_t _8x1[8] __attribute__((aligned(32))) = {1, 1, 1, 1, 1, 1, 1, 1};

const uint16_t _16xv[16] __attribute__((aligned(32))) = {V, V, V, V, V, V, V, V, V, V, V, V, V, V, V, V};
const uint16_t _16x1[16] __attribute__((aligned(32))) = {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1};
const uint16_t _16xq[16]  __attribute__((aligned(32))) = {NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q, NTRUPLUS_Q};
const uint16_t _16xqinv[16] __attribute__((aligned(32))) = {QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV, QINV};

const uint16_t _16xw[16] __attribute__((aligned(32))) = {W, W, W, W, W, W, W, W, W, W, W, W, W, W, W, W};
const uint16_t _16xwqinv[16] __attribute__((aligned(32))) = {WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV, WQINV};

#undef QINV
#undef LOW
#undef V
#undef WQINV
#undef W
